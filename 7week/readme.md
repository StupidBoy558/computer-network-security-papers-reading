# Cookies Lack Integrity: Real-World Implications

**1.**     **论文题目**

**Cookies Lack Integrity: Real-World Implications**

作者：Xiaofeng Zheng; Jian Jiang; Jinjin Liang; Haixin Duan; Shuo Chen; 

Tao Wan; Nicholas Weaver

 

**2.**     **文章概述**

cookie是用于HTTP协议中标识身份的一个特征，它可以设置一个“secure”标志，表明它只能通过HTTPS连接发送。然而，它在实际设置与维护过程中存在一些问题，导致攻击者可以在HTTP连接中插入cookie到HTTPS连接中。本文对该内容进行了深入的实证，并评估了这一攻击的主要危害与防御手段。研究发现，在现实中由于不同浏览器的实现方式差异，有些浏览器在防御这类攻击时表现出较差的防御性能。而且，攻击者可以以较低的成本发起攻击。

**3.**     **主要内容**

文章针对Cookie在设计过程中的宽松性导致的问题进行了详尽的分析，并进行了实例认证。Cookie读/写不对称和缺少域间保护方案，这导致域不能保护其cookie的完整性。一个主要的攻击便是Cookie覆盖攻击，即如果Cookie与相关域共享域范围，则可以使用具有完全相同名称/域/路径的另一个Cookie直接覆盖该域。此外，就是cookie 隐藏，具有相关域控制权的攻击者可以通过注入另一个具有相同名称但域/路径范围不同的攻击者来故意隐藏cookie。

在之前的研究者们都提到了一个已知的漏洞，即攻击者可以通过HTTP响应将cookie注入到后续的HTTPS请求中，并从一个域注入到另一个相关域。这根本的原因是cookie的松散定义。 不幸的是，由于考虑到兼容性，浏览器供应商并没有解决这个问题。然而，本文研究发现这个漏洞并不是一个可以忽略的难以利用的漏洞，反而是一个容易利用危害极大的漏洞。比如，攻击者可以通过在HTTP中向HTTPS中插入cookie数据，从而窃取HTTPS层用户的数据，甚至盗刷信用卡等。

主要攻击模型如下所示：

![Picture1](Picture1.png)               

与此同时，研究者也在现实生活中实验并测试了这种攻击的普遍性和有效性。试验结果表明，这种攻击可以在大多数浏览器中复现，且成本不高，具有较大的危害性。

**4.**     **心得体会**

这篇文章是针对Cookie缺乏完整性进行了一个详尽分析。Cookie缺乏完整性，这个问题在整个社区早已为人所知，但社区都认为对此意义不大，攻击者利用难度较大，比较鸡肋。然而，本文便向大家展示了，事实并非这样，通过一些微妙的构造，攻击者可以进行危害极大的攻击，比如通过HTTP向受HTTPS保护网站中插入数据，窃取cookie，甚至覆盖cookie，又比如通过cookie覆盖来进行dos攻击。

这篇文章向我们展示了，我们不应该盲目相信权威，作为一个安全研究人员应该敢于质疑一切，对现实生活中的所有权威保持一定的真实探究精神，很有可能一个大众认为都安全的解决方案，在实际部署过程中会存在一些问题。此外，本文也告诉我们，细节是最关键的。安全问题之所以这么难解决，最大的一个问题便是细节问题。我们可能在方方面面做了很多处理，提出了很多高大上的解决方案，然而只要我们在任何一个方面的实际执行过程中存在一个细微的小问题，整个系统就变得非常脆弱，攻击者可以通过一个小问题突破整个系统防线。