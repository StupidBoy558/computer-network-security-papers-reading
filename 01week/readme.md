# Network Intrusion Detection: Evasion, Trafﬁc Normalization, and End-to-End Protocol Semantics

**1.**     **论文题目**

**Network Intrusion Detection: Evasion, Trafﬁc Normalization, and End-to-End Protocol Semantics**

作者：Mark Handley and Vern Paxson

发布：USENIX Security 2001

**2.**     **文章概述**

这篇文章主要研究的内容是NIDS，即网络入侵检测系统。面临NIDS时，攻击者常常会利用不同环境中的网络歧义来绕过入侵检测。论文作者针对该问题，引入了一种称为流量标准器的新型网络转发元件来解决这个问题。该元件直接位于流量路径中，并将数据包流打成补丁，以消除监视器看到流量之前的潜在歧义，防止NIDS被攻击者绕过。论文中还针对该方案讨论了在实际运行过程中，“冷启动”和攻击规范化器的影响，并提出了一种方法可以系统地检查协议头部相关的歧义。在性能测试方面，该规范器可以以100，000pkts/sec的速度来处理TCP流，性能较好。

**3.**     **文章细节**

几乎所有的入侵检测系统都会面临最基本的问题，即被攻击者绕过。而在NIDS中，由于流量流在不同环境下的歧义性导致NIDS很难较好地处理流量，而防止被绕过。主要的原因有这么几点：1. NIDS缺乏对特定协议所允许的全部行为的完整分析。2.不同的端系统可能对协议的具体实现不同，对协议流存在歧义性解读。3. 无法详细了解网络拓扑信息，NIDS无法确定网络包是否能够真正到达端系统。正是由于这些原因的限制，NIDS很难处理好被绕过的问题。

因此，论文作者提出了流量归一器的网络转发器，来避免流量被模糊性解读的问题，从而解决NIDS被绕过的问题。

![1](1.png)                                                  

如上，Normalizer即为我们的规范化器，规范化器的作用是保证通过规范化器的流量以准确无歧义的方式进行解读。如此就能较好地保证NIDS的良好运行。

实验方面，作者使用三种不同情况下的流量包测试了该方案，测试结果表明该方案确实可以解决由于网络流量歧义性导致的NIDS绕过问题，且规范器的网络性能较好，可以运行在双向100Mb/s的环境中。

**4.**     **心得体会**

这篇论文于2001年发布，可以说是NIDS方面比较早的文章了。整篇文章逻辑感极强，抽丝剥茧似地跟我们讲述了NIDS方面存在的问题，以及一些当时可能有的解决方案，也为读者讲述了为什么当时的那些方案不可取，需要提出一种新的方案来解决这个问题。在我看来，整篇论文的创新点在于提出了一种方法解决不同环境下的网络歧义性。众所周知，协议在运行过程中的歧义性一直是一个潜在的安全威胁，攻击者可以通过精心定制的payload来绕过，并实现攻击。这种问题不仅仅存在于NIDS领域，还存在其余与协议相关的领域，比如浏览器端。由于不同浏览器可能对协议的具体实现不同，导致在某些情况下，A浏览器与B浏览器对同一流量的处理过程与结果是不同的。在这种情况下，攻击者就很有可能通过一些特制的数据包进行绕过。