# MitM Attack by Name Collision: Cause Analysis and Vulnerability Assessment in the New gTLD Era

**1.**     **论文题目**

**MitM Attack by Name Collision: Cause Analysis and Vulnerability Assessment in the New gTLD Era**

作者：Qi Alfred Chen, Eric Osterweil  , Matthew Thomas  , Z. Morley Mao

**2.**     **文章概述**

这篇文章主要讲述了由于WPAD协议与DNS中的名称冲突机制而引发的中间人代理攻击，这种攻击可以导致internet用户的所有流量自动重定向到MitM代理，从而达到窃听数据的需求。这种攻击的根本问题是内部命名空间WPAD查询的泄漏。本文主要针对该种类型攻击进行了详细的调研、测量与分析，并讨论了如何缓解这种类型的攻击。

**3.**     **主要内容**

在文章中，作者针对这个新暴露的中间人攻击，进行了测试，并测量了在实际使用中的脆弱性及已有的攻击情况。文章主要通过分析在DNS根服务器上收到的泄漏的WPAD查询流量来测量问题的严重性，测量的结果表明这种WPAD流量的泄漏主要原因是终端用户设备的设置问题。更具体来讲是因为用户可能在公司内部使用笔记本电脑时，配置了内部DNS解析记录，来获得自动代理，而当用户离开公司，在外部网络访问时，该配置可能会被错误的使用，从而触发错误的WPAD请求。若此时，有恶意攻击者控制了这个DNS下的记录，则可以控制受害者机器以攻击者指定的代理机器进行网络通讯，从而达到中间人攻击的目的。攻击流程如下图所示：

![Picture1](Picture1.png)

在整个测量过程中发现，每天已经有超过30,000个泄漏的WPAD查询，这些查询中已经观测到有部分请求被攻击。与此同时，整个泄漏源主要来自美国的查询，且主要发生在家庭网络下。实验表明这些泄漏主要原因是当一个域在终端上配置后，第二次查询时终端会自动尝试并连接这个域，从而导致泄漏。

此外，为了探讨这种攻击的普遍性，作者测量了这些容易收到攻击的域名，发现这些域名中将近10%已经被注册。在这种情况下，这些域名注册者可以在任意时刻发起攻击。

**4.**     **心得体会**

这篇文章以小见大，见微知著，文章从DNS与WPAD协议，在新gTLD时代下的小问题，细致地研究了这种问题可能导致的攻击-中间人攻击，并进行了详细的测量，不仅测量了攻击的危害性、覆盖面，还测量了导致这种攻击的WPAD泄漏查询的原因。

此外，有一个很好的研究思路值得我们学习，便很有可能在某个时刻，某个协议会存在一些小问题，但是在那种情况下，这些小问题可能并不能造成任何危害。但是，这种问题永远都是一个隐患，很有可能在协议升级的时候爆发出来。本文讲的在新gTLD部署下导致的这个问题就是一个典型的例子，所以我们平时在进行科研的时候，不要轻易忽略这种现实世界中已存在的、大众认为肯定不会被攻击的场景，很有可能在细致的研究下，我们会发现，事实其实并不是这样的，在这种模式下，恶意攻击者还是能进行攻击并成功利用的！